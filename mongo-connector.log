2018-02-06 16:52:13,017 [ALWAYS] mongo_connector.connector:51 - Starting mongo-connector version: 2.5.1
2018-02-06 16:52:13,017 [ALWAYS] mongo_connector.connector:51 - Python version: 2.7.10 (default, Jul 15 2017, 17:16:57) 
[GCC 4.2.1 Compatible Apple LLVM 9.0.0 (clang-900.0.31)]
2018-02-06 16:52:13,033 [ALWAYS] mongo_connector.connector:51 - Platform: Darwin-17.4.0-x86_64-i386-64bit
2018-02-06 16:52:13,033 [ALWAYS] mongo_connector.connector:51 - pymongo version: 3.6.0
2018-02-06 16:52:13,034 [WARNING] mongo_connector.connector:167 - MongoConnector: Can't find /Users/kayfo/Desktop/backazon/inventory-search-service/oplog.timestamp, attempting to create an empty progress log
2018-02-06 16:52:13,038 [ALWAYS] mongo_connector.connector:51 - Source MongoDB version: 3.6.1
2018-02-06 16:52:13,038 [ALWAYS] mongo_connector.connector:51 - Target DocManager: mongo_connector.doc_managers.elastic2_doc_manager version: 0.3.0
2018-02-06 17:27:58,865 [WARNING] mongo_connector.doc_managers.formatters:110 - Invalid value for key: price as nan
2018-02-06 17:27:58,865 [WARNING] mongo_connector.doc_managers.formatters:110 - Invalid value for key: item_id as nan
2018-02-06 17:27:58,928 [CRITICAL] mongo_connector.oplog_manager:670 - Exception during collection dump
Traceback (most recent call last):
  File "/Library/Python/2.7/site-packages/mongo_connector/oplog_manager.py", line 625, in do_dump
    upsert_all(dm)
  File "/Library/Python/2.7/site-packages/mongo_connector/oplog_manager.py", line 611, in upsert_all
    mapped_ns, long_ts)
  File "/Library/Python/2.7/site-packages/mongo_connector/util.py", line 46, in wrapped
    reraise(new_type, exc_value, exc_tb)
  File "/Library/Python/2.7/site-packages/mongo_connector/util.py", line 35, in wrapped
    return f(*args, **kwargs)
  File "/Library/Python/2.7/site-packages/mongo_connector/doc_managers/elastic2_doc_manager.py", line 367, in bulk_upsert
    for ok, resp in responses:
  File "/Library/Python/2.7/site-packages/elasticsearch/helpers/__init__.py", line 192, in streaming_bulk
    raise_on_error, **kwargs)
  File "/Library/Python/2.7/site-packages/elasticsearch/helpers/__init__.py", line 137, in _process_bulk_chunk
    raise BulkIndexError('%i document(s) failed to index.' % len(errors), errors)
OperationFailed: (u'2 document(s) failed to index.', [{u'index': {u'status': 400, u'_type': u'items', u'_index': u'backazon', u'error': {u'reason': u'Rejecting mapping update to [backazon] as the final mapping would have more than 1 type: [inventory, items]', u'type': u'illegal_argument_exception'}, u'_id': u'5a79fb6afdcec12fa7c956ad', u'data': {u'category': u'test', u'review_count': 0, u'name': u'test', u'color': u'test', u'price': 0, u'description': u'test', u'creation_date': u'Tue Feb 06 2018 11:00:58 GMT-0800 (PST)', u'item_id': 56, u'subcategory': u'test', u'image_url': u'test.png', u'inventory': 100, u'__v': 0, u'department': u'test', u'avg_rating': 0, u'size': u'test'}}}, {u'index': {u'status': 400, u'_type': u'items', u'_index': u'backazon', u'error': {u'reason': u'Rejecting mapping update to [backazon] as the final mapping would have more than 1 type: [inventory, items]', u'type': u'illegal_argument_exception'}, u'_id': u'5a79fb8bfdcec12fa7c956ae', u'data': {u'category': u'test', u'review_count': 0, u'name': u'test', u'color': u'test', u'price': 0, u'description': u'test', u'creation_date': u'Tue Feb 06 2018 11:01:31 GMT-0800 (PST)', u'item_id': 57, u'subcategory': u'test', u'image_url': u'test.png', u'inventory': 100, u'__v': 0, u'department': u'test', u'avg_rating': 0, u'size': u'test'}}}])
2018-02-06 17:27:58,931 [ERROR] mongo_connector.oplog_manager:678 - OplogThread: Failed during dump collection cannot recover! Collection(Database(MongoClient(host=['localhost:27017'], document_class=dict, tz_aware=False, connect=True, replicaset=u'rs0'), u'local'), u'oplog.rs')
2018-02-06 17:27:59,783 [ERROR] mongo_connector.connector:398 - MongoConnector: OplogThread <OplogThread(Thread-3, started 123145545875456)> unexpectedly stopped! Shutting down
